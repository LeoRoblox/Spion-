<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP♱ON DATABASE // SECURE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #050505;
            --accent-red: #ff0000;
            --accent-blue: #008cff;
            --accent-purple: #9d4edd;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: #fff; margin: 0; overflow-x: hidden; }

        /* --- ANIMATIONEN --- */
        .fade-in { animation: fadeIn 0.5s forwards; }
        .fade-out { animation: fadeOut 0.5s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; display: none; } }

        /* --- BUTTON FILL ANIMATION --- */
        .btn-fill {
            position: relative; padding: 12px 25px; background: transparent;
            border: 1px solid var(--border); color: white; cursor: pointer;
            overflow: hidden; z-index: 1; font-weight: bold; text-transform: uppercase;
            display: inline-block;
        }
        .btn-fill::before {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 0;
            z-index: -1; transition: height 0.4s ease-in-out;
        }
        .btn-blue::before { background: var(--accent-blue); }
        .btn-purple::before { background: var(--accent-purple); }
        .btn-red::before { background: var(--accent-red); }
        .btn-white { border: 1px solid white; color: white; }
        .btn-white::before { background: white; }
        .btn-white:hover { color: black; }

        .btn-fill:hover::before { height: 100%; }
        /* Zurück-Animation nach oben beim weghovern ist im Transition-Standard enthalten */

        /* --- AUTH SCREEN --- */
        #auth-screen {
            height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .auth-box { background: var(--glass); padding: 40px; border: 1px solid var(--border); width: 400px; border-radius: 10px; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: bold; }
        .input-group input { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: white; }

        /* --- NAV & PROFILE --- */
        nav {
            padding: 20px 50px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.8);
        }
        .profile-area { position: relative; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .profile-dropdown {
            position: absolute; right: 0; top: 100%; background: #111; border: 1px solid #333;
            padding: 10px; display: none; flex-direction: column; gap: 10px; width: 150px; z-index: 1000;
        }

        /* --- DIENSTAUSWEIS --- */
        .id-card {
            width: 450px; height: 260px; background: #151515; border: 2px solid #333;
            border-radius: 15px; position: relative; padding: 20px; overflow: hidden; margin: 20px auto;
        }
        .id-scanline {
            position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: white; box-shadow: 0 0 10px white; animation: scan 3s linear infinite;
        }
        @keyframes scan { 0% { top: 0%; } 100% { top: 100%; } }
        .id-photo { width: 120px; height: 150px; background: #222; border: 1px solid #444; object-fit: cover; }

        /* --- CASE FRAME --- */
        .case-frame {
            background: #0a0a0a; border: 2px solid var(--accent-purple); padding: 30px;
            max-width: 900px; margin: 40px auto; border-radius: 5px;
        }
        .stammdaten-area {
            width: 100%; height: 200px; background: black; color: lime;
            font-family: 'Courier New', monospace; padding: 15px; border: 1px solid #333;
            white-space: pre; overflow: auto;
        }

        /* --- ADMIN PANEL --- */
        .admin-panel { border: 2px solid var(--accent-red); padding: 20px; background: rgba(255,0,0,0.05); margin-top: 50px; }

        .hidden { display: none; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="auth-box fade-in">
        <div class="input-group">
            <label style="color: var(--accent-blue)"><i class="fas fa-user"></i> SPION NAME</label>
            <input type="text" id="reg-name" placeholder="Name eingeben...">
        </div>
        <div class="input-group">
            <label style="color: var(--accent-red)"><i class="fas fa-fingerprint"></i> CODE</label>
            <input type="number" id="reg-code" placeholder="Zahlen eingeben...">
        </div>
        <button id="auth-main-btn" class="btn-fill btn-purple" style="width: 100%" onclick="handleAuth()">REGISTRIEREN</button>
        <p id="auth-toggle" style="text-align: center; font-size: 14px; cursor: pointer; margin-top: 15px;" onclick="toggleAuth()">
            Du hast schon ein Spion Account? Hier einloggen.
        </p>
    </div>
</div>

<div id="main-ui" class="hidden">
    <nav>
        <div style="color: var(--accent-red); font-weight: 900; font-size: 24px;">SP♱ON</div>
        <div style="display: flex; gap: 20px;">
            <button class="btn-fill btn-blue" onclick="showTab('dashboard')">Dashboard</button>
            <button class="btn-fill btn-purple" onclick="showTab('create-case')">Akte Erstellen</button>
        </div>
        <div class="profile-area" onmouseover="showProfile(true)" onmouseout="showProfile(false)">
            <span id="nav-user-name">NAME</span>
            <div id="p-img-nav" style="width: 40px; height: 40px; border-radius: 50%; background: #333; background-size: cover;"></div>
            <div class="profile-dropdown" id="p-dropdown">
                <button class="btn-fill btn-white" onclick="openSettings()">Einstellungen</button>
                <button class="btn-fill btn-white" onclick="openID()">Dienstausweis</button>
            </div>
        </div>
    </nav>

    <div class="container" style="padding: 50px;">
        
        <div id="tab-dashboard">
            <div id="empty-msg" class="fade-in" style="text-align: center; margin-top: 100px; color: #444;">
                <i class="fas fa-folder-open fa-5x"></i>
                <h2>Es sind bisher keine Akte.</h2>
            </div>
            <div id="case-list"></div>
        </div>

        <div id="tab-create-case" class="hidden">
            <div class="case-frame fade-in">
                <h2 style="color: var(--accent-purple)"><i class="fas fa-file-signature"></i> NEUE FALLAKTE</h2>
                <input type="text" id="case-title" placeholder="FALL TITEL" style="width:100%; padding:10px; margin-bottom:20px; background:black; border:1px solid #333; color:white;">
                <label>STAMMDATEN (ASCII Art Support)</label>
                <textarea class="stammdaten-area" id="case-stammdaten"></textarea>
                <button class="btn-fill btn-red" style="margin-top: 20px;" onclick="saveNewCase()">SPION AKTE ERSTELLEN</button>
            </div>
        </div>

        <div id="frame-settings" class="case-frame hidden">
            <h3>EINSTELLUNGEN</h3>
            <p>PROFIL BILD</p>
            <input type="file" id="upload-p" accept="image/png, image/jpeg">
            <p>Dienstausweis Farbe (HEX)</p>
            <input type="color" id="id-color-picker" value="#9d4edd">
            <button class="btn-fill btn-blue" onclick="saveSettings()">Speichern</button>
        </div>

        <div id="frame-id" class="hidden">
            <div class="id-card" id="id-card-element">
                <div class="id-scanline"></div>
                <div style="display: flex; gap: 20px;">
                    <img id="id-photo-display" src="" class="id-photo">
                    <div>
                        <h2 id="id-name-display" style="margin:0; text-transform:uppercase;">NAME</h2>
                        <div style="color: var(--accent-red); font-weight: bold; margin-bottom: 10px;">SPION</div>
                        <div style="font-family: monospace; font-size: 13px;">
                            ID: <span id="id-num-gen"></span><br>
                            JOINED: <span id="id-date-gen"></span>
                        </div>
                    </div>
                </div>
                <div style="position: absolute; bottom: 10px; right: 10px; font-size: 10px; opacity: 0.6;">
                    <i class="fas fa-shield-alt"></i> OFFICIAL IDENTIFICATION
                </div>
                <div style="position: absolute; bottom: 10px; left: 20px; font-size: 8px; color: gray;">
                    SPION DATABASE // SECURE CONNECTION
                </div>
            </div>
        </div>

        <div class="admin-panel fade-in">
            <h3 style="color: var(--accent-red)">ACCOUNT ERSTELLEN (ADMIN)</h3>
            <button class="btn-fill btn-red" onclick="document.getElementById('admin-form').classList.toggle('hidden')">Account Hinzufügen</button>
            <div id="admin-form" class="hidden" style="margin-top: 20px; border: 1px solid #444; padding: 20px;">
                <label>SPION NAME</label>
                <input type="text" id="adm-name" placeholder="Name mit Sonderzeichen erlaubt...">
                <label>SPION PASSWORT (Nur Zahlen)</label>
                <input type="number" id="adm-pass">
                <button class="btn-fill btn-blue" onclick="adminCreateAccount()">Account erstellen</button>
                <div id="generated-acc" class="hidden" style="background: #111; padding: 15px; margin-top: 15px;">
                    <p>Name: <span id="res-name"></span></p>
                    <p>Pass: <span id="res-pass">****</span> <i class="fas fa-eye" onclick="togglePassView()"></i></p>
                    <p style="color: var(--accent-purple)">CODE (Gültig 1 Min): <span id="minute-code">----</span></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let isLoginMode = false;
    let userData = { name: "", id: "", color: "#9d4edd", photo: "", joined: "" };
    let cases = [];
    let MY_IP = ""; // Wird simuliert

    // IP BYPASS
    window.onload = async () => {
        // Hier könnte man eine echte IP API abfragen, wir simulieren deine IP
        const testIP = "127.0.0.1"; 
        if(testIP === "127.0.0.1") {
            console.log("IP erkannt. Login Bypass aktiviert.");
            // Automatisch registrieren/einloggen
        }
        updateMinuteCode();
        setInterval(updateMinuteCode, 60000);
    };

    function toggleAuth() {
        isLoginMode = !isLoginMode;
        document.getElementById('auth-main-btn').innerText = isLoginMode ? "EINLOGGEN" : "REGISTRIEREN";
        document.getElementById('auth-toggle').innerText = isLoginMode ? "Du hast noch keinen Account? Hier Registrieren." : "Du hast schon ein Spion Account? Hier einloggen.";
    }

    function handleAuth() {
        const name = document.getElementById('reg-name').value;
        const code = document.getElementById('reg-code').value;
        
        if(!name || !code) return alert("Felder ausfüllen!");

        userData.name = name;
        userData.id = "SPION-" + Math.floor(10000 + Math.random() * 90000);
        const d = new Date();
        userData.joined = `${d.getDate()}.${d.getMonth()+1}.${d.getFullYear()}`;
        
        document.getElementById('auth-screen').classList.add('fade-out');
        setTimeout(() => {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-ui').classList.remove('hidden');
            document.getElementById('nav-user-name').innerText = name;
            document.getElementById('id-name-display').innerText = name;
            document.getElementById('id-num-gen').innerText = userData.id;
            document.getElementById('id-date-gen').innerText = userData.joined;
        }, 500);
    }

    function showTab(tab) {
        document.getElementById('tab-dashboard').classList.add('hidden');
        document.getElementById('tab-create-case').classList.add('hidden');
        document.getElementById('tab-' + tab).classList.remove('hidden');
    }

    function showProfile(show) {
        document.getElementById('p-dropdown').style.display = show ? 'flex' : 'none';
    }

    function openSettings() {
        document.getElementById('p-dropdown').classList.add('fade-out');
        document.getElementById('frame-settings').classList.remove('hidden');
        document.getElementById('frame-settings').classList.add('fade-in');
    }

    function saveSettings() {
        const file = document.getElementById('upload-p').files[0];
        const color = document.getElementById('id-color-picker').value;
        
        if(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                userData.photo = e.target.result;
                document.getElementById('p-img-nav').style.backgroundImage = `url(${e.target.result})`;
                document.getElementById('id-photo-display').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        userData.color = color;
        document.getElementById('id-card-element').style.borderColor = color;
        
        document.getElementById('frame-settings').classList.add('fade-out');
        setTimeout(() => document.getElementById('frame-settings').classList.add('hidden'), 500);
    }

    function openID() {
        document.getElementById('frame-id').classList.toggle('hidden');
        document.getElementById('frame-id').classList.add('fade-in');
    }

    function updateMinuteCode() {
        const code = Math.floor(1000 + Math.random() * 9000);
        if(document.getElementById('minute-code')) document.getElementById('minute-code').innerText = code;
    }

    function adminCreateAccount() {
        const n = document.getElementById('adm-name').value;
        const p = document.getElementById('adm-pass').value;
        document.getElementById('res-name').innerText = n;
        document.getElementById('res-pass').innerText = p;
        document.getElementById('generated-acc').classList.remove('hidden');
    }

    function togglePassView() {
        const p = document.getElementById('res-pass');
        p.innerText = p.innerText === "****" ? document.getElementById('adm-pass').value : "****";
    }

    function saveNewCase() {
        const title = document.getElementById('case-title').value;
        const data = document.getElementById('case-stammdaten').value;
        if(!title) return;

        cases.push({ title, data, user: userData.name });
        renderDashboard();
        showTab('dashboard');
    }

    function renderDashboard() {
        const list = document.getElementById('case-list');
        const empty = document.getElementById('empty-msg');
        list.innerHTML = "";
        
        if(cases.length > 0) empty.classList.add('hidden');

        cases.forEach((c, i) => {
            const card = document.createElement('div');
            card.className = "case-frame fade-in";
            card.innerHTML = `
                <h2 style="color:var(--accent-red)">${c.title}</h2>
                <div class="stammdaten-area">${c.data.substring(0, 100)}...</div>
                <button class="btn-fill btn-purple" onclick="openFullCase(${i})">AKTE ÖFFNEN</button>
                <p style="font-size:10px; color:gray">Erstellt von: ${c.user}</p>
                <button class="btn-fill btn-red" style="padding:5px; font-size:10px;" onclick="deleteCase(${i})">LÖSCHEN</button>
            `;
            list.appendChild(card);
        });
    }

    function openFullCase(i) {
        const c = cases[i];
        // KI Zusammenfassung Simulation
        const summary = "KI ANALYSE: Das Dokument '" + c.title + "' enthält verschlüsselte Stammdaten. Relevanzstufe: Hoch.";
        alert("KI ZUSAMMENFASSUNG:\n\n" + summary);
    }

    function deleteCase(i) {
        if(userData.name === "Zynox" || cases[i].user === userData.name) {
            cases.splice(i, 1);
            renderDashboard();
        } else {
            alert("Keine Berechtigung!");
        }
    }
</script>
</body>
</html>
